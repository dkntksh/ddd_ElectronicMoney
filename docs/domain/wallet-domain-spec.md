# Wallet ドメイン仕様

## 目的
本ドメインは「Wallet（電子的な財布）」を表現し、
チャージ・支払い・残高照会に関するビジネスルールを明確にする。

本仕様は **実装よりも先に合意されたルール** を記述するものであり、
アプリケーション層・インフラ層には依存しない。

---

## 用語・ドメインモデル

### Wallet
- お金の残高を保持するエンティティ
- 学習目的のため **初期状態は 0 円** から開始する

#### 責務
- チャージできる
- 支払いできる
- 現在の残高を照会できる

---

### Money（値オブジェクト）
- 金額を表す概念
- **1 円以上でなければならない**
- 0 円の Money は存在しない
- 現時点では通貨の概念は持たない
- 金額の加算・減算などの振る舞いは持たない（後で拡張可能）

---

### ChargeAmount（値オブジェクト）
- 「チャージする金額」を表す概念
- 内部的に Money を保持する

#### ルール
- 1 回のチャージ金額は **10,000 円以下**
- 上限チェックは ChargeAmount の責務
- Wallet 側ではチャージ上限をチェックしない

---

### PayAmount（値オブジェクト）
- 「支払う金額」を表す概念
- 内部的に Money を保持する

#### ルール
- 支払い金額は Wallet の残高以下でなければならない
- 支払い金額自体に上限はない

---

## 振る舞い（ユースケース）

### チャージ
- Wallet は ChargeAmount を引数として受け取る
- ChargeAmount が有効であることを前提とする
- チャージ後、Wallet の残高は増加する

---

### 支払い
- Wallet は PayAmount を引数として受け取る
- 支払い後の残高がマイナスになってはならない
- 残高不足の場合はエラーとする

---

### 残高照会
- Wallet は現在の残高を返す
- 戻り値は Money ではなく、Wallet の状態として解釈される

---

## 不変条件（Invariant）

- Wallet の残高は **決してマイナスにならない**
- 1 回のチャージは **10,000 円以下**
- Money は **1 円以上でなければならない**
- Wallet は 0 円の状態を取りうる

---

## 設計方針

- ビジネスルールは model 層に閉じる
- 不正な状態は「作れない」ことで防ぐ
- 一般的な例外ではなく、意味を表すカスタム例外を使用する
- 将来の拡張は考慮するが、現時点ではシンプルさを優先する

---

## テスト方針

- JUnit によるテストを作成する
- 正常系だけでなく、ルール違反時のテストを含める
    - 10,000 円超のチャージ
    - 残高を超える支払い
